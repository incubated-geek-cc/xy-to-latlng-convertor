!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).converter=e()}(function(){return function n(i,s,a){function o(r,e){if(!s[r]){if(!i[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);throw(t=new Error("Cannot find module '"+r+"'")).code="MODULE_NOT_FOUND",t}t=s[r]={exports:{}},i[r][0].call(t.exports,function(e){return o(i[r][1][e]||e)},t,t.exports,n,i,s,a)}return s[r].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)o(a[e]);return o}({1:[function(e,r,t){e=e("json-2-csv");r.exports=e},{"json-2-csv":6}],2:[function(e,r,t){"use strict";const a=e("./utils.js");function n(e,r){return r=s(r),a.isObject(e)?function t(n,i,s){var e=Object.keys(i).map(e=>{var r=u(n,l(e,s));return c(i[e])?t(r,i[e],s):s.expandArrayObjects&&d(i[e])?o(i[e],r,s):s.ignoreEmptyArrays&&d(i[e])&&!i[e].length?[]:r});return a.flatten(e)}("",e,r):[]}function i(e,r){return r=s(r),e.map(e=>a.isObject(e)?n(e,r):[])}function o(e,t,n){let r=i(e,n);return e.length?e.length&&0===a.flatten(r).length?[t]:(r=r.map(e=>{return r=e,Array.isArray(r)&&!r.length?[t]:e.map(e=>u(t,l(e,n)));var r}),a.unique(a.flatten(r))):n.ignoreEmptyArraysWhenExpanding?[]:[t]}function l(e,r){return r.escapeNestedDots?e.replace(/\./g,"\\."):e}function u(e,r){return e?e+"."+r:r}function c(e){return a.isObject(e)&&!a.isNull(e)&&!Array.isArray(e)&&Object.keys(e).length}function d(e){return Array.isArray(e)}function s(e){return{expandArrayObjects:!1,ignoreEmptyArraysWhenExpanding:!1,escapeNestedDots:!1,ignoreEmptyArrays:!1,...e||{}}}r.exports={deepKeys:n,deepKeysFromList:i}},{"./utils.js":3}],3:[function(e,r,t){"use strict";r.exports={isNull:function(e){return null===e},isObject:function(e){return"object"==typeof e},unique:function(e){return[...new Set(e)]},flatten:function(e){return[].concat(...e)}}},{}],4:[function(e,r,t){"use strict";function o(e){var r=function(r){for(let e=0;e<r.length;e++){var t=0<e?r[e-1]:"";if("."===r[e]&&"\\"!==t)return e}return-1}(e);return{dotIndex:r,key:e.slice(0,0<=r?r:void 0).replace(/\\./g,"."),remaining:e.slice(r+1)}}r.exports={evaluatePath:function r(e,t){if(!e)return null;var{dotIndex:n,key:i,remaining:s}=o(t);return 0<=n&&!e[t]?Array.isArray(e[i])?e[i].map(e=>r(e,s)):r(e[i],s):Array.isArray(e)?e.map(e=>r(e,t)):0<=n&&t!==i&&e[i]?r(e[i],s):-1===n&&e[i]&&!e[t]?e[i]:e[t]},setPath:function(e,r,t){if(!e)throw new Error("No object was provided.");if(!r)throw new Error("No keyPath was provided.");return function r(e,t,n){var{dotIndex:i,key:s,remaining:a}=o(t);if(t.startsWith("__proto__")||t.startsWith("constructor")||t.startsWith("prototype"))return e;if(0<=i){if(!e[s]&&Array.isArray(e))return e.forEach(e=>r(e,t,n));e[s]||(e[s]={}),r(e[s],a,n)}else{if(Array.isArray(e))return e.forEach(e=>r(e,a,n));e[s]=n}return e}(e,r,t)}}},{}],5:[function(e,r,t){r.exports={errors:{callbackRequired:"A callback is required!",optionsRequired:"Options were not passed and are required.",json2csv:{cannotCallOn:"Cannot call json2csv on ",dataCheckFailure:"Data provided was not an array of documents.",notSameSchema:"Not all documents have the same schema."},csv2json:{cannotCallOn:"Cannot call csv2json on ",dataCheckFailure:"CSV is not a string."}},defaultOptions:{delimiter:{field:",",wrap:'"',eol:"\n"},excelBOM:!1,prependHeader:!0,trimHeaderFields:!1,trimFieldValues:!1,sortHeader:!1,parseCsvNumbers:!1,keys:null,checkSchemaDifferences:!1,expandArrayObjects:!1,unwindArrays:!1,useDateIso8601Format:!1,useLocaleFormat:!1,parseValue:null,wrapBooleans:!1},values:{excelBOM:"\ufeff"}}},{}],6:[function(e,r,t){"use strict";let{Json2Csv:n}=e("./json2csv"),{Csv2Json:i}=e("./csv2json"),s=e("./utils");function a(e,r,t,n){return s.convert({data:r,callback:t,options:n,converter:e})}function o(e,r,i){return new Promise((t,n)=>a(e,r,(e,r)=>e?n(e):t(r),i))}function l(e,r,t,n,i){return console.warn("WARNING: "+r+" is deprecated and will be removed soon. Please use "+t+" instead."),o(e,n,i)}r.exports={json2csv:(e,r,t)=>a(n,e,r,t),csv2json:(e,r,t)=>a(i,e,r,t),json2csvAsync:(e,r)=>o(n,e,r),csv2jsonAsync:(e,r)=>o(i,e,r),json2csvPromisified:(e,r)=>l(n,"json2csvPromisified()","json2csvAsync()",e,r),csv2jsonPromisified:(e,r)=>l(i,"csv2jsonPromisified()","csv2jsonAsync()",e,r)}},{"./csv2json":7,"./json2csv":8,"./utils":9}],7:[function(e,r,t){"use strict";let p=e("doc-path"),m=e("./constants.json"),h=e("./utils");r.exports={Csv2Json:function(f){const s=new RegExp(f.delimiter.wrap+f.delimiter.wrap,"g"),t=new RegExp("^"+m.values.excelBOM),n=f.parseValue&&"function"==typeof f.parseValue?f.parseValue:JSON.parse;function i(e){let r={lines:e},t=r.lines[0];return r.headerFields=t.map((e,r)=>({value:function(e){return e=c(e),f.trimHeaderFields?e.split(".").map(e=>e.trim()).join("."):e}(e),index:r})),f.keys&&(r.headerFields=r.headerFields.filter(e=>f.keys.includes(e.value))),r}function a(e){return Promise.resolve(function(e){let r=[],t=[],n,i,s,a,o=e.length-1,l=f.delimiter.eol.length,u={insideWrapDelimiter:!1,parsingValue:!0,justParsedDoubleQuote:!1,startIndex:0},c=0;for(;c<e.length;){if(n=e[c],i=c?e[c-1]:"",s=c<o?e[c+1]:"",a=h.getNCharacters(e,c,l),(a!==f.delimiter.eol||u.insideWrapDelimiter)&&c!==o||i!==f.delimiter.field)if(c===o&&n===f.delimiter.field){var d=e.substring(u.startIndex,c);t.push(d),t.push(""),r.push(t)}else if(c===o||a===f.delimiter.eol&&(!u.insideWrapDelimiter||u.insideWrapDelimiter&&i===f.delimiter.wrap&&!u.justParsedDoubleQuote)){d=c!==o||i===f.delimiter.wrap?c:void 0;t.push(e.substring(u.startIndex,d)),r.push(t),t=[],u.startIndex=c+l,u.parsingValue=!0,u.insideWrapDelimiter=s===f.delimiter.wrap}else if((i!==f.delimiter.wrap||u.justParsedDoubleQuote&&i===f.delimiter.wrap)&&n===f.delimiter.wrap&&h.getNCharacters(e,c+1,l)===f.delimiter.eol)u.insideWrapDelimiter=!1,u.parsingValue=!1;else if(n!==f.delimiter.wrap||0!==c&&h.getNCharacters(e,c-l,l)!==f.delimiter.eol)if(n===f.delimiter.wrap&&s===f.delimiter.field)t.push(e.substring(u.startIndex,c+1)),u.startIndex=c+2,u.insideWrapDelimiter=!1,u.parsingValue=!1;else if(n!==f.delimiter.wrap||i!==f.delimiter.field||u.insideWrapDelimiter||u.parsingValue)if(n===f.delimiter.wrap&&i===f.delimiter.field&&!u.insideWrapDelimiter&&u.parsingValue)t.push(e.substring(u.startIndex,c-1)),u.insideWrapDelimiter=!0,u.parsingValue=!0,u.startIndex=c;else{if(n===f.delimiter.wrap&&s===f.delimiter.wrap){c+=2,u.justParsedDoubleQuote=!0;continue}n===f.delimiter.field&&i!==f.delimiter.wrap&&s!==f.delimiter.wrap&&!u.insideWrapDelimiter&&u.parsingValue?(t.push(e.substring(u.startIndex,c)),u.startIndex=c+1):n!==f.delimiter.field||i!==f.delimiter.wrap||s===f.delimiter.wrap||u.parsingValue||(u.insideWrapDelimiter=!1,u.parsingValue=!0,u.startIndex=c+1)}else u.startIndex=c,u.insideWrapDelimiter=!0,u.parsingValue=!0;else u.insideWrapDelimiter=!0,u.parsingValue=!0,u.startIndex=c;else a===f.delimiter.eol&&u.startIndex===c||n===f.delimiter.field?t.push(""):t.push(e.substr(u.startIndex)),t.push(""),r.push(t),t=[],u.startIndex=c+l,u.parsingValue=!0,u.insideWrapDelimiter=s===f.delimiter.wrap;c++,u.justParsedDoubleQuote=!1}return r}(e))}function o(e){return e.recordLines=e.lines.splice(1),e}function l(e,r){return function(e){var r=function(r){try{if(h.isStringRepresentation(r,f)&&!h.isDateRepresentation(r))return r;let e=n(r);return Array.isArray(e)?e.map(u):e}catch(e){return e}}(e);h.isError(r)||h.isInvalid(r)?"undefined"===e&&(e=void 0):e=r;return e}(e[r.index])}function u(e){return f.trimFieldValues&&!h.isNull(e)?e.trim():e}function c(e){var r=e[0],t=e.length-1,n=e[t];return r===f.delimiter.wrap&&n===f.delimiter.wrap?e.substr(1,t-1):e}function d(i){return i.json=i.recordLines.reduce((e,r)=>{r=r.map(e=>{return e=c(e),e=u(e=e.replace(s,f.delimiter.wrap))});var t,n,t=(t=i.headerFields,n=r,t.reduce((r,e)=>{var t=l(n,e);try{return p.setPath(r,e.value,t)}catch(e){return r}},{}));return e.concat(t)},[]),i}return{convert:function(e,r){e=e,(f.excelBOM?Promise.resolve(e.replace(t,"")):Promise.resolve(e)).then(a).then(i).then(o).then(d).then(e=>r(null,e.json)).catch(r)},validationFn:h.isString,validationMessages:m.errors.csv2json}}}},{"./constants.json":5,"./utils":9,"doc-path":4}],8:[function(e,r,t){"use strict";let g=e("doc-path"),w=e("deeks"),j=e("./constants.json"),x=e("./utils");r.exports={Json2Csv:function(i){const t=new RegExp(i.delimiter.wrap,"g"),n=/\r?\n|\r/,s=i.parseValue&&"function"==typeof i.parseValue?i.parseValue:function(e){var r=x.isDate(e);return x.isNull(e)||Array.isArray(e)||x.isObject(e)&&!r?JSON.stringify(e):x.isUndefined(e)?"undefined":r&&i.useDateIso8601Format?e.toISOString():i.useLocaleFormat?e.toLocaleString():e.toString()},e=i.expandArrayObjects&&!i.unwindArrays,r={expandArrayObjects:e,ignoreEmptyArraysWhenExpanding:e,escapeNestedDots:!0};function a(e){if(i.checkSchemaDifferences)return function(e){var r=e[0],e=e.slice(1),e=function(t,e){return e.reduce((e,r)=>{return 0<x.computeSchemaDifferences(t,r).length?e+1:e},0)}(r,e);if(e)return Promise.reject(new Error(j.errors.json2csv.notSameSchema));return Promise.resolve(r)}(e);e=x.unique(x.flatten(e));return Promise.resolve(e)}function o(e){return i.excludeKeys?e.filter(e=>!i.excludeKeys.includes(e)):e}function l(e){return i.sortHeader?e.sort():e}function u(e){return i.trimHeaderFields&&(e.headerFields=e.headerFields.map(e=>e.split(".").map(e=>e.trim()).join("."))),e}function c(e){return i.prependHeader&&(e.headerFields=e.headerFields.map(y)),e}function d(e){let r=Object.keys(i.fieldTitleMap);return e.header=e.headerFields.map(function(e){return y(r.includes(e)?i.fieldTitleMap[e]:e)}).join(i.delimiter.field),e}function f(e){return i.keys&&(i.keys=i.keys.map(e=>x.isObject(e)&&e.field?(i.fieldTitleMap[e.field]=e.title||e.field,e.field):e)),i.keys&&!i.unwindArrays?Promise.resolve(i.keys).then(o).then(l):(e=e,Promise.resolve(w.deepKeysFromList(e,r)).then(a).then(o).then(l))}function p(r,t){if(i.unwindArrays){var n=r.records.length;return r.headerFields.forEach(e=>{r.records=x.unwind(r.records,e)}),f(r.records).then(e=>(r.headerFields=e,n!==r.records.length?p(r):t?(i.keys&&(r.headerFields=o(i.keys)),r):p(r,!0)))}return r}function m(n){return n.records=n.records.map(e=>{let r=function(t,e){let n=[];return e.forEach(e=>{let r=g.evaluatePath(t,e);!x.isUndefined(i.emptyFieldValue)&&x.isEmptyField(r)?r=i.emptyFieldValue:i.expandArrayObjects&&Array.isArray(r)&&(r=function(e){var r=x.removeEmptyFields(e);{if(!e.length||!r.length)return i.emptyFieldValue||"";if(1===r.length)return r[0]}return e}(r)),n.push(r)}),n}(e,n.headerFields),t=r.map(e=>(e=h(e),e=y(e=s(e))));return t.join(i.delimiter.field)}).join(i.delimiter.eol),n}function h(e){return i.trimFieldValues?Array.isArray(e)?e.map(h):x.isString(e)?e.trim():e:e}function y(e){var r=i.delimiter.wrap;return e.includes(i.delimiter.wrap)&&(e=e.replace(t,r+r)),(e.includes(i.delimiter.field)||e.includes(i.delimiter.wrap)||e.match(n)||i.wrapBooleans&&("true"===e||"false"===e))&&(e=r+e+r),e}function v(e){var r=e.header,t=e.records,t=(i.excelBOM?j.values.excelBOM:"")+(i.prependHeader?r+i.delimiter.eol:"")+t;return e.callback(null,t)}return{convert:function(r,t){x.isObject(r)&&!r.length&&(r=[r]),f(r).then(e=>({headerFields:e,callback:t,records:r})).then(p).then(m).then(c).then(u).then(d).then(v).catch(t)},validationFn:x.isObject,validationMessages:j.errors.json2csv}}}},{"./constants.json":5,"./utils":9,deeks:2,"doc-path":4}],9:[function(e,r,t){"use strict";let s=e("doc-path"),a=e("./constants.json");const n=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;function o(e){return JSON.parse(JSON.stringify(e))}function i(e){return c(e)||u(e)||""===e}function l(e){return"object"==typeof e}function u(e){return null===e}function c(e){return void 0===e}function d(e,r){return e.filter(e=>!r.includes(e))}r.exports={isStringRepresentation:function(e,r){var t=e[0],n=e.length-1,n=e[n];return t===r.delimiter.wrap&&n===r.delimiter.wrap},isDateRepresentation:function(e){return n.test(e)},computeSchemaDifferences:function(e,r){return d(e,r).concat(d(r,e))},deepCopy:o,convert:function(e){var{options:r,callback:t}=function(e,r){return l(e)&&"function"!=typeof e?{options:e,callback:r}:{options:r,callback:e}}(e.callback,e.options);r=function(e){return(e={...a.defaultOptions,...e||{}}).fieldTitleMap=new Map,e.delimiter.field=e.delimiter.field||a.defaultOptions.delimiter.field,e.delimiter.wrap=e.delimiter.wrap||a.defaultOptions.delimiter.wrap,e.delimiter.eol=e.delimiter.eol||a.defaultOptions.delimiter.eol,e}(r);let n=new e.converter(r),i=function(e){if(e.callback)return e.data?!!e.dataCheckFn(e.data)||(e.callback(new Error(e.errorMessages.dataCheckFailure)),!1):(e.callback(new Error(e.errorMessages.cannotCallOn+e.data+".")),!1);throw new Error(a.errors.callbackRequired)}({data:e.data,callback:t,errorMessages:n.validationMessages,dataCheckFn:n.validationFn});i&&n.convert(e.data,t)},isEmptyField:i,removeEmptyFields:function(e){return e.filter(e=>!i(e))},getNCharacters:function(e,r,t){return e.substring(r,r+t)},unwind:function(e,r){var t=[];return e.forEach(e=>{!function(r,t,n){const e=s.evaluatePath(t,n);let i=o(t);Array.isArray(e)&&e.length?e.forEach(e=>{i=o(t),r.push(s.setPath(i,n,e))}):(Array.isArray(e)&&0===e.length&&s.setPath(i,n,""),r.push(i))}(t,e,r)}),t},isInvalid:function(e){return e===1/0||e===-1/0},isString:function(e){return"string"==typeof e},isNull:u,isError:function(e){return"[object Error]"===Object.prototype.toString.call(e)},isDate:function(e){return e instanceof Date},isUndefined:c,isObject:l,unique:function(e){return[...new Set(e)]},flatten:function(t){if(t.flat)return t.flat();if(1e5<t.length){let r=[];for(let e=0;e<t.length;e+=1e5)r=r.concat(...t.slice(e,e+1e5));return r}return[].concat(...t)}}},{"./constants.json":5,"doc-path":4}]},{},[1])(1)});